<!DOCTYPE html><html xmlns:dc="http://purl.org/dc/terms/"><head><meta http-equiv=Content-Type content="text/html; charset=utf-8"><title>PeterO.Mail.Message</title><meta name="viewport" content="width=device-width"><link rel=stylesheet type="text/css" href="/style.css">
            <script type="text/x-mathjax-config"> MathJax.Hub.Config({"HTML-CSS": { availableFonts: ["STIX","TeX"], linebreaks: { automatic:true }, preferredFont: "TeX" },
                    tex2jax: { displayMath: [ ["$$","$$"], ["\\[", "\\]"] ], inlineMath: [ ["$", "$"], ["\\\\(","\\\\)"] ], processEscapes: true } });
            </script><script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML-full"></script></head><body>  <div class="header">
<nav><p><a href="#navigation">Menu</a> - <a href="#top">Top</a> - <a href="/">Home</a></nav></div>
<div class="mainarea" id="top">
<h1>PeterO.Mail.Message</h1>
<p>## PeterO.Mail.Message</p>

<pre>public sealed class Message
</pre>

<p>Represents an email message, and contains methods and properties for accessing and modifying email message data. This class implements the Internet Message Format (RFC 5322) and Multipurpose Internet Mail Extensions (MIME; RFC 2045-2047, RFC 2049).</p>

<p><b>Thread safety:</b> This class is mutable; its properties can be changed. None of its instance methods are designed to be thread safe. Therefore, access to objects from this class must be synchronized if multiple threads can access them at the same time.</p>

<p>The following lists known deviations from the mail specifications (Internet Message Format and MIME):</p>

<ul>
  <li>
    <p>If a message has two or more Content-Type header fields, it is treated as having a content type of “application/octet-stream”, unless one or more of the header fields is syntactically invalid.</p>
  </li>
  <li>
    <p>Illegal UTF-8 byte sequences appearing in header field values are replaced with replacement characters. Moreover, UTF-8 is parsed everywhere in header field values, even in those parts of some structured header fields where this appears not to be allowed. (UTF-8 is a character encoding for the Unicode character set.)</p>
  </li>
  <li>
    <p>This implementation can parse a message even if that message is without a From header field, without a Date header field, or without both.</p>
  </li>
  <li>
    <p>The To and Cc header fields are allowed to contain only comments and whitespace, but these “empty” header fields will be omitted when generating.</p>
  </li>
  <li>
    <p>There is no line length limit imposed when parsing header fields, except header field names.</p>
  </li>
  <li>
    <p>There is no line length limit imposed when parsing quoted-printable or base64 encoded bodies.</p>
  </li>
  <li>
    <p>If the transfer encoding is absent and the content type is “message/rfc822”, bytes with values greater than 127 are still allowed, despite the default value of “7bit” for “Content-Transfer-Encoding”.</p>
  </li>
  <li>
    <p>In the following cases, if the transfer encoding is absent, declared as 7bit, or treated as 7bit, bytes greater than 127 are still allowed:</p>
  </li>
  <li>
    <p>(a) The preamble and epilogue of multipart messages, which will be ignored.</p>
  </li>
  <li>
    <p>(b) If the charset is declared to be  <code>utf-8</code> .</p>
  </li>
  <li>
    <p>(c) If the content type is “text/html” and the charset is declared to be  <code>us-ascii</code> , “windows-1252”, “windows-1251”, or “iso-8859-*” (all single byte encodings).</p>
  </li>
  <li>
    <p>(d) In text/plain message bodies. Any bytes greater than 127 are replaced with the substitute character byte (0x1a).</p>
  </li>
  <li>
    <p>(e) In MIME message bodies (this is not a deviation from MIME, though). Any bytes greater than 127 are replaced with the substitute character byte (0x1a).</p>
  </li>
  <li>
    <p>If the message starts with the word “From” (and no other case variations of that word) followed by one or more space (U+0020) not followed by colon, that text and the rest of the text is skipped up to and including a line feed (U+000A). (See also RFC 4155, which describes the so-called “mbox” convention with “From” lines of this kind.)</p>
  </li>
  <li>
    <p>The name  <code>ascii</code>  is treated as a synonym for  <code>us-ascii</code> , despite being a reserved name under RFC 2046. The names  <code>cp1252</code>  and  <code>utf8</code>  are treated as synonyms for  <code>windows-1252</code>  and  <code>utf-8</code> , respectively, even though they are not IANA registered aliases.</p>
  </li>
  <li>
    <p>The following deviations involve encoded words under RFC 2047:</p>
  </li>
  <li>
    <p>(a) If a sequence of encoded words decodes to a string with a CTL character (U+007F, or a character less than U+0020 and not TAB) after being converted to Unicode, the encoded words are left un-decoded.</p>
  </li>
  <li>
    <p>(b) This implementation can decode encoded words regardless of the character length of the line in which they appear. This implementation can generate a header field line with one or more encoded words even if that line is more than 76 characters long. (This implementation follows the recommendation in RFC 5322 to limit header field lines to no more than 78 characters, where possible; see also RFC 6532.)</p>
  </li>
</ul>

<p>It would be appreciated if users of this library contact the author if they find other ways in which this implementation deviates from the mail specifications or other applicable specifications.</p>

<p>If a MIME message or body part has an unrecognized transfer encoding, its content type is treated as “application/octet-stream” rather than the declared content type (per MIME) and its transfer encoding is treated as 7bit (a clarification to MIME).</p>

<p>This class currently doesn’t support the “padding” parameter for message bodies with the media type “application/octet-stream” or treated as that media type (see RFC 2046 sec. 4.5.1).</p>

<p>In this implementation, if the content-transfer-encoding “quoted-printable” or “base64” occurs in a message or body part with content type “multipart/<em>” or “message/</em>” (other than “message/global”, “message/global-headers”, “message/global-disposition-notification”, or “message/global-delivery-status”), that encoding is treated as unrecognized for the purpose of treating that message or body part as having a content type of “application/octet-stream” rather than the declared content type. This is a clarification to RFCs 2045 and 2049. (This may result in “misdecoded” messages because in practice, most if not all messages of this kind don’t use quoted-printable or base64 encodings for the whole body, but may do so in the body parts they contain.)</p>

<p>This implementation can decode an RFC 2047 encoded word that uses ISO-2022-JP or ISO-2022-JP-2 (encodings that use code switching) even if the encoded word’s payload ends in a different mode from “ASCII mode”. (Each encoded word still starts in “ASCII mode”, though.) This, however, is not a deviation to RFC 2047 because the relevant rule only concerns bringing the output device back to “ASCII mode” after the decoded text is displayed (see last paragraph of sec. 6.2) – since the decoded text is converted to Unicode rather than kept as ISO-2022-JP or ISO-2022-JP-2, this is not applicable since there is no such thing as “ASCII mode” in the Unicode Standard.</p>

<p>Note that this library (the MailLib library) has no facilities for sending and receiving email messages, since that’s outside this library’s scope.</p>

<h3 id="member-summary">Member Summary</h3>
<ul>
  <li><code>[AddAttachment(PeterO.Mail.MediaType)](#AddAttachment_PeterO_Mail_MediaType)</code> -</li>
  <li><code>[AddAttachment(System.IO.Stream, PeterO.Mail.MediaType)](#AddAttachment_System_IO_Stream_PeterO_Mail_MediaType)</code> -</li>
  <li><code>[AddAttachment(System.IO.Stream, PeterO.Mail.MediaType, string)](#AddAttachment_System_IO_Stream_PeterO_Mail_MediaType_string)</code> -</li>
  <li><code>[AddAttachment(System.IO.Stream, string)](#AddAttachment_System_IO_Stream_string)</code> -</li>
  <li><code>[AddHeader(string, string)](#AddHeader_string_string)</code> -</li>
  <li><code>[AddHeader(System.Collections.Generic.KeyValuePair)](#AddHeader_System_Collections_Generic_KeyValuePair)</code> -</li>
  <li><code>[AddInline(PeterO.Mail.MediaType)](#AddInline_PeterO_Mail_MediaType)</code> -</li>
  <li><code>[AddInline(System.IO.Stream, PeterO.Mail.MediaType)](#AddInline_System_IO_Stream_PeterO_Mail_MediaType)</code> -</li>
  <li><code>[AddInline(System.IO.Stream, PeterO.Mail.MediaType, string)](#AddInline_System_IO_Stream_PeterO_Mail_MediaType_string)</code> -</li>
  <li><code>[AddInline(System.IO.Stream, string)](#AddInline_System_IO_Stream_string)</code> -</li>
  <li><code>[BccAddresses](#BccAddresses)</code> - <b>Deprecated:</b> Use GetAddresses("Bcc") instead.</li>
  <li><code>[BodyString](#BodyString)</code> - <b>Deprecated:</b> Use GetBodyString() instead.</li>
  <li><code>[CCAddresses](#CCAddresses)</code> - <b>Deprecated:</b> Use GetAddresses("Cc") instead.</li>
  <li><code>[ClearHeaders()](#ClearHeaders)</code> - Deletes all header fields in this message.</li>
  <li><code>[ContentDisposition](#ContentDisposition)</code> - Gets or sets this message’s content disposition.</li>
  <li><code>[ContentType](#ContentType)</code> - Gets or sets this message’s media type.</li>
  <li><code>[DecodeHeaderValue(string, string)](#DecodeHeaderValue_string_string)</code> -</li>
  <li><code>[ExtractHeader(byte[], string)](#ExtractHeader_byte_string)</code> -</li>
  <li><code>[FileName](#FileName)</code> - Gets a file name suggested by this message for saving the message’s body to a file.</li>
  <li><code>[FromAddresses](#FromAddresses)</code> - <b>Deprecated:</b> Use GetAddresses("From") instead.</li>
  <li><code>[FromMailtoUri(string)](#FromMailtoUri_string)</code> -</li>
  <li><code>[FromMailtoUri(System.Uri)](#FromMailtoUri_System_Uri)</code> -</li>
  <li><code>[FromMailtoUrl(string)](#FromMailtoUrl_string)</code> - <b>Deprecated:</b> Renamed to FromMailtoUri.</li>
  <li><code>[Generate()](#Generate)</code> - Generates this message’s data in text form.</li>
  <li><code>[GenerateBytes()](#GenerateBytes)</code> - Generates this message’s data as a byte array, using the same algorithm as the Generate method.</li>
  <li><code>[GetAddresses(string)](#GetAddresses_string)</code> -</li>
  <li><code>[GetAttachments()](#GetAttachments)</code> - Gets a list of descendant body parts of this message that are considered attachments.</li>
  <li><code>[GetBody()](#GetBody)</code> - Gets the byte array for this message’s body.</li>
  <li><code>[GetBodyMessage()](#GetBodyMessage)</code> - Returns the mail message contained in this message’s body.</li>
  <li><code>[GetBodyString()](#GetBodyString)</code> - Gets the body of this message as a text string.</li>
  <li><code>[GetDate()](#GetDate)</code> - Gets the date and time extracted from this message’s Date header field (the value of which is found as though GetHeader(“date”) were called).</li>
  <li><code>[GetFormattedBodyString()](#GetFormattedBodyString)</code> - Gets a Hypertext Markup Language (HTML) rendering of this message’s text body.</li>
  <li><code>[GetHeader(int)](#GetHeader_int)</code> -</li>
  <li><code>[GetHeader(string)](#GetHeader_string)</code> -</li>
  <li><code>[GetHeaderArray(string)](#GetHeaderArray_string)</code> -</li>
  <li><code>[HeaderFields](#HeaderFields)</code> - Gets a snapshot of the header fields of this message, in the order in which they appear in the message.</li>
  <li><code>[MakeMultilingualMessage(System.Collections.Generic.IList, System.Collections.Generic.IList)](#MakeMultilingualMessage_System_Collections_Generic_IList_System_Collections_Generic_IList)</code> -</li>
  <li><code>[NewBodyPart()](#NewBodyPart)</code> - Creates a message object with no header fields.</li>
  <li><code>[Parts](#Parts)</code> - Gets a list of all the parts of this message.</li>
  <li><code>[RemoveHeader(int)](#RemoveHeader_int)</code> -</li>
  <li><code>[RemoveHeader(string)](#RemoveHeader_string)</code> -</li>
  <li><code>[SelectLanguageMessage(System.Collections.Generic.IList)](#SelectLanguageMessage_System_Collections_Generic_IList)</code> -</li>
  <li><code>[SelectLanguageMessage(System.Collections.Generic.IList, bool)](#SelectLanguageMessage_System_Collections_Generic_IList_bool)</code> -</li>
  <li><code>[SetBody(byte[])](#SetBody_byte)</code> -</li>
  <li><code>[SetCurrentDate()](#SetCurrentDate)</code> - Sets this message’s Date header field to the current time as its value, with an unspecified time zone offset.</li>
  <li><code>[SetDate(int[])](#SetDate_int)</code> -</li>
  <li><code>[SetHeader(int, string)](#SetHeader_int_string)</code> -</li>
  <li><code>[SetHeader(int, string, string)](#SetHeader_int_string_string)</code> -</li>
  <li><code>[SetHeader(int, System.Collections.Generic.KeyValuePair)](#SetHeader_int_System_Collections_Generic_KeyValuePair)</code> -</li>
  <li><code>[SetHeader(string, string)](#SetHeader_string_string)</code> -</li>
  <li><code>[SetHtmlBody(string)](#SetHtmlBody_string)</code> -</li>
  <li><code>[SetTextAndHtml(string, string)](#SetTextAndHtml_string_string)</code> -</li>
  <li><code>[SetTextAndMarkdown(string, string)](#SetTextAndMarkdown_string_string)</code> -</li>
  <li><code>[SetTextBody(string)](#SetTextBody_string)</code> -</li>
  <li><code>[Subject](#Subject)</code> - Gets or sets this message’s subject.</li>
  <li><code>[ToAddresses](#ToAddresses)</code> - <b>Deprecated:</b> Use GetAddresses("To") instead.</li>
  <li><code>[ToMailtoUri()](#ToMailtoUri)</code> - Generates a MailTo URI (uniform resource identifier) corresponding to this message.</li>
  <li><code>[ToMailtoUrl()](#ToMailtoUrl)</code> - <b>Deprecated:</b> Renamed to ToMailtoUri.</li>
</ul>

<p><a id="Void_ctor_Byte"></a>
### Message Constructor</p>

<pre>public Message(
    byte[] bytes);
</pre>

<p>Initializes a new instance of the <a href="PeterO.Mail.Message.html">PeterO.Mail.Message</a> class. Reads from the given byte array to initialize the email message.</p>

<p><b>Remarks:</b>This constructor parses an email message, and extracts its header fields and body, and throws a MessageDataException if the message is malformed. However, even if a MessageDataException is thrown, it can still be possible to display the message, especially because most email malformations seen in practice are benign in nature (such as the use of very long lines in the message). One way an application can handle the exception is to display the message, or part of it, as raw text (using  <code>DataUtilities.GetUtf8String(bytes, true)</code>  ), and to optionally extract important header fields, such as From, To, Date, and Subject, from the message’s text using the  <code>ExtractHeader</code>  method. Even so, though, any message for which this constructor throws a MessageDataException ought to be treated with suspicion.</p>

<p><b>Parameters:</b></p>

<ul>
  <li><i>bytes</i>: A readable data stream.</li>
</ul>

<p><b>Exceptions:</b></p>

<ul>
  <li>
    <p>System.ArgumentNullException:
The parameter  <i>bytes</i>
 is null.</p>
  </li>
  <li>
    <p>PeterO.Mail.MessageDataException:
The message is malformed. See the remarks.</p>
  </li>
</ul>

<p><a id="Void_ctor_System_IO_Stream"></a>
### Message Constructor</p>

<pre>public Message(
    System.IO.Stream stream);
</pre>

<p>Initializes a new instance of the <a href="PeterO.Mail.Message.html">PeterO.Mail.Message</a> class. Reads from the given Stream object to initialize the email message.</p>

<p><b>Remarks:</b>This constructor parses an email message, and extracts its header fields and body, and throws a MessageDataException if the message is malformed. However, even if a MessageDataException is thrown, it can still be possible to display the message, especially because most email malformations seen in practice are benign in nature (such as the use of very long lines in the message). One way an application can handle the exception is to read all the bytes from the stream, to display the message, or part of it, as raw text (using  <code>DataUtilities.GetUtf8String(bytes, true)</code>  ), and to optionally extract important header fields, such as From, To, Date, and Subject, from the message’s text using the  <code>ExtractHeader</code>  method. Even so, though, any message for which this constructor throws a MessageDataException ought to be treated with suspicion.</p>

<p><b>Parameters:</b></p>

<ul>
  <li><i>stream</i>: A readable data stream.</li>
</ul>

<p><b>Exceptions:</b></p>

<ul>
  <li>
    <p>System.ArgumentNullException:
The parameter  <i>stream</i>
 is null.</p>
  </li>
  <li>
    <p>PeterO.Mail.MessageDataException:
The message is malformed. See the remarks.</p>
  </li>
</ul>

<p><a id="Void_ctor"></a>
### Message Constructor</p>

<pre>public Message();
</pre>

<p>Initializes a new instance of the <a href="PeterO.Mail.Message.html">PeterO.Mail.Message</a> class. The message will be plain text and have an artificial From address.</p>

<p><a id="BccAddresses"></a>
### BccAddresses</p>

<pre>public System.Collections.Generic.IList BccAddresses { get; }
</pre>

<p><b>Deprecated.</b> Use GetAddresses(“Bcc”) instead.</p>

<p>Gets a list of addresses found in the BCC header field or fields.</p>

<p><b>Returns:</b></p>

<p>A list of addresses found in the BCC header field or fields.</p>

<p><a id="BodyString"></a>
### BodyString</p>

<pre>public string BodyString { get; }
</pre>

<p><b>Deprecated.</b> Use GetBodyString() instead.</p>

<p>Gets the body of this message as a text string. See the  <code>GetBodyString()</code>  method.</p>

<p><b>Returns:</b></p>

<p>The body of this message as a text string.</p>

<p><b>Exceptions:</b></p>

<ul>
  <li>System.NotSupportedException:
See the  <code>GetBodyString()</code>  method.</li>
</ul>

<p><a id="CCAddresses"></a>
### CCAddresses</p>

<pre>public System.Collections.Generic.IList CCAddresses { get; }
</pre>

<p><b>Deprecated.</b> Use GetAddresses(“Cc”) instead.</p>

<p>Gets a list of addresses found in the CC header field or fields.</p>

<p><b>Returns:</b></p>

<p>A list of addresses found in the CC header field or fields.</p>

<p><a id="ContentDisposition"></a>
### ContentDisposition</p>

<pre>public PeterO.Mail.ContentDisposition ContentDisposition { get; set; }
</pre>

<p>Gets or sets this message’s content disposition. The content disposition specifies how a user agent should display or otherwise handle this message. Can be set to null. If set to a disposition or to null, updates the Content-Disposition header field as appropriate. (There is no default content disposition if this value is null, and disposition types unrecognized by the application should be treated as “attachment”; see RFC 2183 sec. 2.8.).</p>

<p><b>Returns:</b></p>

<p>This message’s content disposition, or null if none is specified.</p>

<p><a id="ContentType"></a>
### ContentType</p>

<pre>public PeterO.Mail.MediaType ContentType { get; set; }
</pre>

<p>Gets or sets this message’s media type. When getting, the media type may differ in certain cases from the value of the Content-Type header field, if any, and may have a value even if the Content-Type header field is absent from this message. If set to a media type, updates the Content-Type header field as appropriate. Cannot be set to null.</p>

<p><b>Returns:</b></p>

<p>This message’s media type.</p>

<p><b>Exceptions:</b></p>

<ul>
  <li>System.ArgumentNullException:
This value is being set and “value” is null.</li>
</ul>

<p><a id="FileName"></a>
### FileName</p>

<pre>public string FileName { get; }
</pre>

<p>Gets a file name suggested by this message for saving the message’s body to a file. For more information on the algorithm, see ContentDisposition.MakeFilename.</p>

<p>This method generates a file name based on the  <code>filename</code>  parameter of the Content-Disposition header field, if it exists, or on the  <code>name</code>  parameter of the Content-Type header field, otherwise.</p>

<p><b>Returns:</b></p>

<p>A suggested name for the file. Returns the empty string if there is no filename suggested by the content type or content disposition, or if that filename is an empty string.</p>

<p><a id="FromAddresses"></a>
### FromAddresses</p>

<pre>public System.Collections.Generic.IList FromAddresses { get; }
</pre>

<p><b>Deprecated.</b> Use GetAddresses(“From”) instead.</p>

<p>Gets a list of addresses found in the From header field or fields.</p>

<p><b>Returns:</b></p>

<p>A list of addresses found in the From header field or fields.</p>

<p><a id="HeaderFields"></a>
### HeaderFields</p>

<pre>public System.Collections.Generic.IList HeaderFields { get; }
</pre>

<p>Gets a snapshot of the header fields of this message, in the order in which they appear in the message. For each item in the list, the key is the header field’s name (where any basic uppercase letters, U+0041 to U+005A, are converted to basic lowercase letters) and the value is the header field’s value.</p>

<p><b>Returns:</b></p>

<p>A snapshot of the header fields of this message.</p>

<p><a id="Parts"></a>
### Parts</p>

<pre>public System.Collections.Generic.IList Parts { get; }
</pre>

<p>Gets a list of all the parts of this message. This list is editable. This will only be used if the message is a multipart message.</p>

<p><b>Returns:</b></p>

<p>A list of all the parts of this message. This list is editable. This will only be used if the message is a multipart message.</p>

<p><a id="Subject"></a>
### Subject</p>

<pre>public string Subject { get; set; }
</pre>

<p>Gets or sets this message’s subject. The subject’s value is found as though GetHeader(“subject”) were called.</p>

<p><b>Returns:</b></p>

<p>This message’s subject, or null if there is none.</p>

<p><a id="ToAddresses"></a>
### ToAddresses</p>

<pre>public System.Collections.Generic.IList ToAddresses { get; }
</pre>

<p><b>Deprecated.</b> Use GetAddresses(“To”) instead.</p>

<p>Gets a list of addresses found in the To header field or fields.</p>

<p><b>Returns:</b></p>

<p>A list of addresses found in the To header field or fields.</p>

<p><a id="ClearHeaders"></a>
### ClearHeaders</p>

<pre>public PeterO.Mail.Message ClearHeaders();
</pre>

<p>Deletes all header fields in this message. Also clears this message’s content disposition and resets its content type to MediaType.TextPlainAscii.</p>

<p><b>Return Value:</b></p>

<p>This object.</p>

<p><a id="Generate"></a>
### Generate</p>

<pre>public string Generate();
</pre>

<p>Generates this message’s data in text form. The generated message will have only Basic Latin code points (U+0000 to U+007F), and the transfer encoding will always be 7bit, quoted-printable, or base64 (the declared transfer encoding for this message will be ignored).</p>

<p>The following applies to the following header fields: From, To, Cc, Bcc, Reply-To, Sender, Resent-To, Resent-From, Resent-Cc, Resent-Bcc, and Resent-Sender. If the header field exists, but has an invalid syntax, has no addresses, or appears more than once, this method will combine the addresses into one header field if possible (in the case of all fields given other than From and Sender), and otherwise generate a synthetic header field with the display-name set to the contents of all of the header fields with the same name, and the address set to  <code>me@[header-name]-address.invalid</code>  as the address (a  <code>.invalid</code>  address is a reserved address that can never belong to anyone). (An exception is that the Resent-* header fields may appear more than once.) The generated message should always have a From header field.</p>

<p>If a Date and/or Message-ID header field doesn’t exist, a field with that name will be generated (using the current local time for the Date field).</p>

<p>When encoding the message’s body, if the message has a text content type (“text/*”), the line breaks are a CR byte (carriage return, 0x0d) followed by an LF byte (line feed, 0x0a), CR alone, or LF alone. If the message has any other content type, only CR followed by LF is considered a line break.</p>

<p><b>Return Value:</b></p>

<p>The generated message.</p>

<p><b>Exceptions:</b></p>

<ul>
  <li>PeterO.Mail.MessageDataException:
The message can’t be generated.</li>
</ul>

<p><a id="GenerateBytes"></a>
### GenerateBytes</p>

<pre>public byte[] GenerateBytes();
</pre>

<p>Generates this message’s data as a byte array, using the same algorithm as the Generate method.</p>

<p><b>Return Value:</b></p>

<p>The generated message as a byte array.</p>

<p><a id="GetAttachments"></a>
### GetAttachments</p>

<pre>public System.Collections.Generic.IList GetAttachments();
</pre>

<p>Gets a list of descendant body parts of this message that are considered attachments. An <i>attachment</i> is a body part or descendant body part that has a content disposition with a type other than inline. This message itself is not included in the list even if it’s an attachment as just defined.</p>

<p><b>Return Value:</b></p>

<p>A list of descendant body parts of this message that are considered attachments.</p>

<p><a id="GetBody"></a>
### GetBody</p>

<pre>public byte[] GetBody();
</pre>

<p>Gets the byte array for this message’s body. This method doesn’ t make a copy of that byte array.</p>

<p><b>Return Value:</b></p>

<p>A byte array.</p>

<p><a id="GetBodyMessage"></a>
### GetBodyMessage</p>

<pre>public PeterO.Mail.Message GetBodyMessage();
</pre>

<p>Returns the mail message contained in this message’s body.</p>

<p><b>Return Value:</b></p>

<p>A message object if this object’s content type is “message/rfc822”, “message/news”, or “message/global”, or null otherwise.</p>

<p><a id="GetBodyString"></a>
### GetBodyString</p>

<pre>public string GetBodyString();
</pre>

<p>Gets the body of this message as a text string. If this message’s media type is “multipart/alternative”, returns the result of this method for the last supported body part. For any other “multipart” media type, returns the result of this method for the first body part for which this method returns a text string.</p>

<p><b>Return Value:</b></p>

<p>The body of this message as a text string.</p>

<p><b>Exceptions:</b></p>

<ul>
  <li>System.NotSupportedException:
This message is a multipart message without a supported body part; or this message has a content disposition with a type other than “inline”; or this message’s media type is a nonmultipart type and does not specify the use of a “charset” parameter, has no character encoding declared or assumed for it (which is usually the case for nontext messages), or has an unsupported character encoding.</li>
</ul>

<p><a id="GetDate"></a>
### GetDate</p>

<pre>public int[] GetDate();
</pre>

<p>Gets the date and time extracted from this message’s Date header field (the value of which is found as though GetHeader(“date”) were called). See <b>MailDateTime.ParseDateString(string, bool)</b> for more information on the format of the date-time array returned by this method.</p>

<p><b>Return Value:</b></p>

<p>An array of 32-bit unsigned integers.</p>

<p><a id="GetFormattedBodyString"></a>
### GetFormattedBodyString</p>

<pre>public string GetFormattedBodyString();
</pre>

<p>Gets a Hypertext Markup Language (HTML) rendering of this message’s text body. This method currently supports any message for which  <code>GetBodyString()</code>  gives out a text string and treats the following media types specially: text/plain with  <code>format=flowed</code> , text/enriched, text/markdown (original Markdown).</p>

<p>REMARK: The Markdown implementation currently supports all features of original Markdown, except that the implementation:</p>

<ul>
  <li>
    <p>does not strictly check the placement of “block-level HTML elements”,</p>
  </li>
  <li>
    <p>does not prevent Markdown content from being interpreted as such merely because it’s contained in a “block-level HTML element”, and</p>
  </li>
  <li>
    <p>does not deliberately use HTML escapes to obfuscate email addresses wrapped in angle-brackets.</p>
  </li>
</ul>

<p><b>Return Value:</b></p>

<p>An HTML rendering of this message’s text.</p>

<p><b>Exceptions:</b></p>

<ul>
  <li>System.NotSupportedException:
No supported body part was found; see  <code>GetBodyString()</code>  for more information.</li>
</ul>

<p><a id="NewBodyPart"></a>
### NewBodyPart</p>

<pre>public static PeterO.Mail.Message NewBodyPart();
</pre>

<p>Creates a message object with no header fields.</p>

<p><b>Return Value:</b></p>

<p>A message object with no header fields.</p>

<p><a id="SetCurrentDate"></a>
### SetCurrentDate</p>

<pre>public PeterO.Mail.Message SetCurrentDate();
</pre>

<p>Sets this message’s Date header field to the current time as its value, with an unspecified time zone offset. This method can be used when the message is considered complete and ready to be generated, for example, using the “Generate()” method.</p>

<p><b>Return Value:</b></p>

<p>This object.</p>

<p><a id="ToMailtoUri"></a>
### ToMailtoUri</p>

<pre>public string ToMailtoUri();
</pre>

<p>Generates a MailTo URI (uniform resource identifier) corresponding to this message. The following header fields, and only these, are used to generate the URI: To, Cc, Bcc, In-Reply-To, Subject, Keywords, Comments. The message body is included in the URI only if  <code>GetBodyString()</code>  would return a nonempty string.. The To header field is included in the URI only if it has display names or group syntax.</p>

<p><b>Return Value:</b></p>

<p>A MailTo URI corresponding to this message.</p>

<p><a id="ToMailtoUrl"></a>
### ToMailtoUrl</p>

<pre>public string ToMailtoUrl();
</pre>

<p><b>Deprecated.</b> Renamed to ToMailtoUri.</p>

<p>Generates a MailTo URI (uniform resource identifier) corresponding to this message. The following header fields, and only these, are used to generate the URI: To, Cc, Bcc, In-Reply-To, Subject, Keywords, Comments. The message body is included in the URI only if  <code>GetBodyString()</code>  would return a nonempty string. The To header field is included in the URI only if it has display names or group syntax.</p>

<p><b>Return Value:</b></p>

<p>A MailTo URI corresponding to this message.</p>

<p><a href="/MailLib/">Back to MailLib start page.</a></p>
</div><nav id="navigation"><ul>
<li><a href="/">Back to start site.</a>
<li><a href="https://github.com/peteroupc/peteroupc.github.io">This site's repository (source code)</a>
<li><a href="https://github.com/peteroupc/peteroupc.github.io/issues">Post an issue or comment</a></ul>

<div class="noprint">
<p>
<a href="//twitter.com/intent/tweet">Share via Twitter</a>, <a href="//www.facebook.com/sharer/sharer.php" id="sharer">Share via Facebook</a>
</p>
</div>
</nav></body></html>
